# ProductMind AI ç³»ç»Ÿéƒ¨ç½²è®°å½•

## ç³»ç»Ÿæ¶æ„æ¦‚è¿°

ProductMind AI åŒ…å«ä¸‰å¥—ç³»ç»Ÿï¼š
1. **å‰ç«¯ç³»ç»Ÿ** - React + Vite åº”ç”¨ (ç«¯å£ 8888)
2. **Netlify Functions** - æ•°æ®åº“APIæœåŠ¡ (ç«¯å£ 8888)
3. **AWSåç«¯æœåŠ¡** - AIå†…å®¹ç”ŸæˆæœåŠ¡ (ç«¯å£ 3001)

## éƒ¨ç½²å†å²è®°å½•

### 2025å¹´6æœˆ18æ—¥ - é‡å¤§ç³»ç»Ÿé‡æ„éƒ¨ç½²

#### é—®é¢˜1: Node.jsç‰ˆæœ¬å†²çª
**ç°è±¡ï¼š**
- ç³»ç»Ÿä½¿ç”¨Node.js v18.20.8ï¼Œä½†é¡¹ç›®éœ€è¦v20+
- PM2ä½¿ç”¨ç³»ç»ŸNode.jsï¼Œå¯¼è‡´ç‰ˆæœ¬ä¸åŒ¹é…
- å‰ç«¯æ„å»ºå¤±è´¥ï¼Œä¾èµ–å®‰è£…è­¦å‘Š

**åŸå› åˆ†æï¼š**
- æœåŠ¡å™¨åŒæ—¶å­˜åœ¨ç³»ç»ŸNode.js v18.20.8å’Œnvmç®¡ç†çš„v20.12.2
- PM2é»˜è®¤ä½¿ç”¨ç³»ç»ŸNode.jsè·¯å¾„
- æ–°ç‰ˆæœ¬ä¾èµ–è¦æ±‚Node.js >= 20.18.0

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. åˆ é™¤ç³»ç»ŸNode.js
sudo yum remove nodejs npm -y

# 2. åˆ›å»ºç¬¦å·é“¾æ¥æŒ‡å‘nvmç‰ˆæœ¬
sudo ln -sf /home/ec2-user/.nvm/versions/node/v20.12.2/bin/node /usr/bin/node
sudo ln -sf /home/ec2-user/.nvm/versions/node/v20.12.2/bin/npm /usr/bin/npm

# 3. éªŒè¯ç‰ˆæœ¬
node --version  # v20.12.2
npm --version   # 10.5.0
```

**é¢„é˜²æªæ–½ï¼š**
- ç»Ÿä¸€ä½¿ç”¨nvmç®¡ç†Node.jsç‰ˆæœ¬
- éƒ¨ç½²å‰æ£€æŸ¥Node.jsç‰ˆæœ¬å…¼å®¹æ€§
- æ›´æ–°éƒ¨ç½²è„šæœ¬ç§»é™¤nvmç¯å¢ƒsourcing

#### é—®é¢˜2: æ•°æ®åº“è¡¨åé”™è¯¯
**ç°è±¡ï¼š**
- http://productmindai.com/ai-products é¡µé¢æ— æ³•è·å–æ•°æ®
- APIè¿”å›ç©ºç»“æœæˆ–é”™è¯¯
- å‰ç«¯æ˜¾ç¤º"Login functionality will be implemented"

**åŸå› åˆ†æï¼š**
- `netlify/functions-js/get-projects-by-category.cjs` ç¬¬138è¡Œ
- æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨é”™è¯¯è¡¨åï¼š`user_projectscategory`
- æ­£ç¡®è¡¨ååº”ä¸ºï¼š`user_projects_category`

**è§£å†³æ–¹æ¡ˆï¼š**
```javascript
// é”™è¯¯ä»£ç  (ç¬¬138è¡Œ)
FROM user_projectscategory upc

// ä¿®å¤åä»£ç 
FROM user_projects_category upc
```

**éªŒè¯ç»“æœï¼š**
```bash
# æµ‹è¯•ä¿®å¤åçš„å‡½æ•°
node netlify/functions-js/get-projects-by-category.cjs
# âœ… æˆåŠŸè·å– 2 ä¸ªé¡¹ç›®ï¼Œæ€»è®¡ 495 ä¸ª
# Success: true, Projects count: 2
```

#### é—®é¢˜3: Netlify CLIæ‰§è¡Œå¤±è´¥
**ç°è±¡ï¼š**
- `npx netlify dev` å‘½ä»¤å¤±è´¥
- PM2æ—¥å¿—æ˜¾ç¤º "npm ERR! could not determine executable to run"
- APIç«¯ç‚¹è¿”å›502 Bad Gateway

**åŸå› åˆ†æï¼š**
- Netlify CLIåœ¨PM2ç¯å¢ƒä¸‹æ‰§è¡Œå¼‚å¸¸
- npxå‘½ä»¤è·¯å¾„è§£æé—®é¢˜
- æœåŠ¡å¯åŠ¨å¤±è´¥å¯¼è‡´APIä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆï¼š**
åˆ›å»ºç‹¬ç«‹çš„FunctionsæœåŠ¡å™¨ (`functions-server.cjs`)ï¼š
```javascript
const express = require('express');
const cors = require('cors');
require('dotenv').config();

const app = express();
const PORT = 8888;

// å¯¼å…¥functions-jsè„šæœ¬
const getCategories = require('./netlify/functions-js/get-categories.cjs');
const getProjectsByCategory = require('./netlify/functions-js/get-projects-by-category.cjs');
const checkCategoryCodes = require('./netlify/functions-js/check-category-codes.cjs');

// è®¾ç½®APIè·¯ç”±
app.get('/.netlify/functions/get-categories', async (req, res) => {
    const result = await getCategories.handler({
        httpMethod: 'GET',
        queryStringParameters: req.query,
        headers: req.headers
    });
    res.status(result.statusCode || 200).send(result.body);
});

// å…¶ä»–è·¯ç”±...
```

**éƒ¨ç½²å‘½ä»¤ï¼š**
```bash
# å®‰è£…ä¾èµ–
npm install express cors

# å¯åŠ¨æœåŠ¡
pm2 start functions-server.cjs --name "functions-server"
pm2 start aws-backend/src/server.ts --name "aws-backend" --interpreter ts-node
```

#### é—®é¢˜4: å‰ç«¯é‡æ–°æ„å»ºéœ€æ±‚
**ç°è±¡ï¼š**
- å‡çº§Node.jsåå‰ç«¯éœ€è¦é‡æ–°ç¼–è¯‘
- æ—§çš„æ„å»ºæ–‡ä»¶ä½¿ç”¨v18ç¼–è¯‘ï¼Œä¸v20ä¸å…¼å®¹
- ç½‘ç«™è®¿é—®å¼‚å¸¸

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. æ¸…ç†æ—§æ–‡ä»¶
rm -rf node_modules dist .netlify

# 2. é‡æ–°å®‰è£…ä¾èµ–
npm install

# 3. é‡æ–°æ„å»º
npm run build

# 4. éªŒè¯æ„å»ºç»“æœ
ls -la dist/
```

#### é—®é¢˜5: Nginxé…ç½®ä¸æœåŠ¡ç«¯å£ä¸åŒ¹é…
**ç°è±¡ï¼š**
- Nginxé…ç½®ä»£ç†åˆ°é”™è¯¯ç«¯å£
- APIè¯·æ±‚è¿”å›502é”™è¯¯
- æœåŠ¡é—´é€šä¿¡å¤±è´¥

**åŸå› åˆ†æï¼š**
- Nginxé…ç½®æ–‡ä»¶ `/etc/nginx/conf.d/productmind.conf` å­˜åœ¨
- ä½†æ‰€æœ‰è¯·æ±‚éƒ½ä»£ç†åˆ° `localhost:8888`
- éœ€è¦ç¡®ä¿FunctionsæœåŠ¡åœ¨8888ç«¯å£æ­£å¸¸è¿è¡Œ

**è§£å†³æ–¹æ¡ˆï¼š**
```nginx
# /etc/nginx/conf.d/productmind.conf
server {
    listen 80;
    server_name productmindai.com www.productmindai.com;
    
    # Netlifyå‡½æ•°ä»£ç†åˆ°8888ç«¯å£
    location /.netlify/functions/ {
        proxy_pass http://localhost:8888;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # é™æ€æ–‡ä»¶æœåŠ¡
    root /home/productmindaidev/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

## æœ€ç»ˆéƒ¨ç½²çŠ¶æ€

### æœåŠ¡è¿è¡ŒçŠ¶æ€
```bash
pm2 status
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name                â”‚ mode        â”‚ pid     â”‚ status  â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ functions-server    â”‚ fork        â”‚ 1811072 â”‚ online  â”‚ 58.9mb   â”‚
â”‚ 1  â”‚ aws-backend         â”‚ fork        â”‚ 1817555 â”‚ online  â”‚ 80.8mb   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•éªŒè¯ç»“æœ
```bash
# APIæµ‹è¯•æˆåŠŸ
curl -s "http://productmindai.com/.netlify/functions/get-categories" | jq .success
# true

curl -s "http://productmindai.com/.netlify/functions/get-projects-by-category?category=å…¨éƒ¨&search=&language=zh" | jq .success  
# true
```

### æ•°æ®åº“è¿æ¥éªŒè¯
- âœ… Supabaseè¿æ¥æ­£å¸¸
- âœ… ç¯å¢ƒå˜é‡åŠ è½½æˆåŠŸ
- âœ… æ•°æ®æŸ¥è¯¢è¿”å›æ­£ç¡®ç»“æœ
- âœ… æ€»è®¡495ä¸ªé¡¹ç›®ï¼Œ45ä¸ªåˆ†ç±»

## éƒ¨ç½²æœ€ä½³å®è·µ

### 1. ç¯å¢ƒå‡†å¤‡æ£€æŸ¥æ¸…å•
- [ ] Node.jsç‰ˆæœ¬å…¼å®¹æ€§ (>= 20.12.2)
- [ ] ç¯å¢ƒå˜é‡å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•
- [ ] ç«¯å£å ç”¨æƒ…å†µæ£€æŸ¥

### 2. éƒ¨ç½²é¡ºåº
1. åœæ­¢æ‰€æœ‰ç›¸å…³æœåŠ¡ `pm2 stop all`
2. æ¸…ç†æ—§æ„å»ºæ–‡ä»¶ `rm -rf node_modules dist .netlify`
3. é‡æ–°å®‰è£…ä¾èµ– `npm install`
4. é‡æ–°æ„å»ºå‰ç«¯ `npm run build`
5. å¯åŠ¨FunctionsæœåŠ¡å™¨ `pm2 start functions-server.cjs`
6. å¯åŠ¨AWSåç«¯æœåŠ¡ `pm2 start aws-backend/src/server.ts --interpreter ts-node`
7. éªŒè¯æ‰€æœ‰APIç«¯ç‚¹

### 3. æ•…éšœæ’æŸ¥æ­¥éª¤
1. æ£€æŸ¥PM2æœåŠ¡çŠ¶æ€ `pm2 status`
2. æŸ¥çœ‹æœåŠ¡æ—¥å¿— `pm2 logs [service-name]`
3. æµ‹è¯•ç«¯å£è¿é€šæ€§ `curl http://localhost:8888/health`
4. éªŒè¯Nginxé…ç½® `sudo nginx -t`
5. æ£€æŸ¥æ•°æ®åº“è¿æ¥

### 4. å…³é”®æ–‡ä»¶å¤‡ä»½
- `/etc/nginx/conf.d/productmind.conf` - Nginxé…ç½®
- `functions-server.cjs` - FunctionsæœåŠ¡å™¨
- `netlify/functions-js/` - æ•°æ®åº“APIè„šæœ¬
- `.env` - ç¯å¢ƒå˜é‡é…ç½®

### 5. ç›‘æ§å’Œç»´æŠ¤
- å®šæœŸæ£€æŸ¥PM2æœåŠ¡çŠ¶æ€
- ç›‘æ§æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ
- å¤‡ä»½é‡è¦é…ç½®æ–‡ä»¶
- å®šæœŸæµ‹è¯•APIç«¯ç‚¹å¯ç”¨æ€§

## ç»éªŒæ•™è®­

1. **ç‰ˆæœ¬ç®¡ç†é‡è¦æ€§**ï¼šNode.jsç‰ˆæœ¬ä¸å…¼å®¹ä¼šå¯¼è‡´å„ç§å¥‡æ€ªçš„é—®é¢˜ï¼Œå¿…é¡»ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†ã€‚

2. **æ•°æ®åº“è¡¨åæ£€æŸ¥**ï¼šçœ‹ä¼¼ç®€å•çš„æ‹¼å†™é”™è¯¯å¯èƒ½å¯¼è‡´æ•´ä¸ªåŠŸèƒ½å¤±æ•ˆï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ã€‚

3. **æœåŠ¡ä¾èµ–å…³ç³»**ï¼šç†è§£å„æœåŠ¡é—´çš„ä¾èµ–å…³ç³»ï¼Œç¡®ä¿å¯åŠ¨é¡ºåºæ­£ç¡®ã€‚

4. **å·¥å…·å…¼å®¹æ€§**ï¼šæŸäº›CLIå·¥å…·åœ¨ç‰¹å®šç¯å¢ƒä¸‹å¯èƒ½ä¸å·¥ä½œï¼Œéœ€è¦å‡†å¤‡æ›¿ä»£æ–¹æ¡ˆã€‚

5. **å®Œæ•´æµ‹è¯•**ï¼šéƒ¨ç½²åå¿…é¡»è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸ã€‚

## æœªæ¥æ”¹è¿›å»ºè®®

1. åˆ›å»ºè‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼Œå‡å°‘äººå·¥æ“ä½œé”™è¯¯
2. æ·»åŠ å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯æœºåˆ¶
3. å®æ–½é…ç½®æ–‡ä»¶ç‰ˆæœ¬æ§åˆ¶
4. å»ºç«‹å®Œæ•´çš„æµ‹è¯•å¥—ä»¶
5. æ·»åŠ æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶

---

### 2025å¹´6æœˆ20æ—¥ - ç¯å¢ƒå˜é‡è§„èŒƒåŒ–ä¸åå°æ¨¡æ¿ç”Ÿæˆä¼˜åŒ–éƒ¨ç½²

#### éƒ¨ç½²èƒŒæ™¯
æœ¬æ¬¡éƒ¨ç½²çš„ä¸»è¦ç›®æ ‡æ˜¯ï¼š
1. è§„èŒƒåŒ–ç¯å¢ƒå˜é‡æ–‡ä»¶ç®¡ç†ï¼Œé¿å…é‡å¤çš„é…ç½®é”™è¯¯
2. ä¼˜åŒ–æ¨¡æ¿åˆ†ç±»è¿‡æ»¤ï¼Œåªå¤„ç†éœ€è¦æ˜¾ç¤ºçš„æ¨¡æ¿ï¼ˆisshow=1ï¼‰
3. å®ç°å‰ç«¯APIæœåŠ¡ä¸åå°æ¨¡æ¿ç”Ÿæˆä»»åŠ¡çš„å¹¶è¡Œè¿è¡Œ
4. æå‡ç³»ç»Ÿç¨³å®šæ€§å’Œè¿ç»´æ•ˆç‡

#### ä¸»è¦æ”¹è¿›å†…å®¹

##### 1. ç¯å¢ƒå˜é‡æ–‡ä»¶æ ‡å‡†åŒ–

**é—®é¢˜åˆ†æï¼š**
- é¡¹ç›®ä¸­å­˜åœ¨å¤šä¸ª `.env` æ–‡ä»¶ï¼Œå¯¼è‡´é…ç½®æ··ä¹±
- ä¸åŒè„šæœ¬ä½¿ç”¨ä¸åŒçš„ç¯å¢ƒå˜é‡è·¯å¾„
- é¢‘ç¹å‡ºç°"Database not configured"é”™è¯¯

**è§£å†³æ–¹æ¡ˆï¼š**
- å»ºç«‹ `aws-backend/.env` ä½œä¸ºæ ‡å‡†ç¯å¢ƒå˜é‡æ–‡ä»¶
- åˆ›å»º `docs/ç¯å¢ƒå˜é‡æ–‡ä»¶è¯´æ˜.md` è§„èŒƒæ–‡æ¡£
- ç»Ÿä¸€æ‰€æœ‰è„šæœ¬çš„ç¯å¢ƒå˜é‡åŠ è½½æ–¹å¼

**æ ‡å‡†é…ç½®ï¼š**
```bash
# aws-backend/.env (æ ‡å‡†è·¯å¾„)
SUPABASE_URL=https://uobwbhvwrciaxloqdizc.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIs...
DEEPSEEK_API_KEY=sk-567abb67b99d4a65acaa2d9ed06c3782
```

**ä»£ç è§„èŒƒï¼š**
```javascript
// âœ… æ­£ç¡®ä½¿ç”¨æ–¹å¼
require('dotenv').config({ path: 'aws-backend/.env' });

// âŒ é”™è¯¯ä½¿ç”¨æ–¹å¼
require('dotenv').config();  // å¯èƒ½æ‰¾ä¸åˆ°é…ç½®
```

##### 2. æ¨¡æ¿åˆ†ç±»è¿‡æ»¤ä¼˜åŒ–

**é—®é¢˜åˆ†æï¼š**
- æ‰¹é‡ç”Ÿäº§è„šæœ¬å¤„ç†æ‰€æœ‰æ¨¡æ¿ï¼ˆ32ä¸ªï¼‰ï¼ŒåŒ…æ‹¬ä¸éœ€è¦æ˜¾ç¤ºçš„æ¨¡æ¿
- é€ æˆ78.1%çš„æ— æ•ˆå¤„ç†ï¼Œæµªè´¹AI Tokenå’Œå­˜å‚¨ç©ºé—´
- æ²¡æœ‰æŒ‰ç…§ä¸šåŠ¡éœ€æ±‚è¿‡æ»¤æ¨¡æ¿åˆ†ç±»

**è§£å†³æ–¹æ¡ˆï¼š**
- ä¿®æ”¹æ¨¡æ¿æŸ¥è¯¢SQLï¼Œåªè·å– `template_categories.isshow=1` çš„æ¨¡æ¿
- ä»32ä¸ªæ¨¡æ¿è¿‡æ»¤åˆ°7ä¸ªæœ‰æ•ˆæ¨¡æ¿
- å¤§å¹…æå‡æ‰¹é‡ç”Ÿäº§æ•ˆç‡

**ä¼˜åŒ–å‰æŸ¥è¯¢ï¼š**
```sql
SELECT * FROM templates LIMIT 10
```

**ä¼˜åŒ–åæŸ¥è¯¢ï¼š**
```sql
SELECT id,name_zh,name_en,prompt_content,mdcprompt,template_categories!inner(id,name_zh,isshow) 
FROM templates 
WHERE template_categories.isshow=1
```

**æ•ˆæœéªŒè¯ï¼š**
```bash
# æµ‹è¯•ç»“æœ
ğŸ§ª æµ‹è¯•æ¨¡æ¿åˆ†ç±»è¿‡æ»¤åŠŸèƒ½
ğŸ“‹ æµ‹è¯•1: è·å–æ‰€æœ‰æ¨¡æ¿ - 32ä¸ª
ğŸ“‹ æµ‹è¯•2: è·å–isshow=1çš„åˆ†ç±»ä¸‹çš„æ¨¡æ¿ - 7ä¸ª
ğŸ“Š è¿‡æ»¤æ¯”ä¾‹: 78.1%
âœ… è¿‡æ»¤åŠŸèƒ½æ­£å¸¸å·¥ä½œ
```

##### 3. å¹¶è¡ŒæœåŠ¡éƒ¨ç½²æ¶æ„

**éƒ¨ç½²ç­–ç•¥ï¼š**
- å‰ç«¯APIæœåŠ¡ï¼šä½¿ç”¨PM2ç®¡ç†ï¼Œæä¾›ç½‘ç«™æ•°æ®æŸ¥è¯¢
- åå°æ¨¡æ¿ç”Ÿæˆï¼šç‹¬ç«‹è¿›ç¨‹è¿è¡Œï¼Œä¸å½±å“å‰ç«¯æœåŠ¡
- ç¯å¢ƒéš”ç¦»ï¼šä½¿ç”¨ç»Ÿä¸€çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œé¿å…é…ç½®å†²çª

**æœåŠ¡æ¶æ„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx (ç«¯å£ 80)                 â”‚
â”‚    http://productmindai.com                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  é™æ€æ–‡ä»¶æœåŠ¡    â”‚
         â”‚  (Reactå‰ç«¯)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    /.netlify/functions/* è¯·æ±‚
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ functions-server â”‚
         â”‚   (PM2ç®¡ç†)     â”‚
         â”‚   ç«¯å£ 8888     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
              æ•°æ®åº“æŸ¥è¯¢
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Supabase      â”‚
         â”‚   æ•°æ®åº“        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åå°æ¨¡æ¿ç”Ÿæˆä»»åŠ¡                   â”‚
â”‚  large-scale-batch-production-optimized-v2  â”‚
â”‚            (ç‹¬ç«‹è¿›ç¨‹)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éƒ¨ç½²æ‰§è¡Œè¿‡ç¨‹

##### æ­¥éª¤1: åœæ­¢å†²çªè¿›ç¨‹
```bash
# å‘ç°å¹¶åœæ­¢é‡å¤çš„æ‰¹é‡ç”Ÿäº§è¿›ç¨‹
ps aux | grep large-scale-batch
kill -9 723236  # åœæ­¢æ—§è¿›ç¨‹(14:06å¯åŠ¨)
# ä¿ç•™æ–°è¿›ç¨‹(17:04å¯åŠ¨)
```

##### æ­¥éª¤2: ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ¢å¤ç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.backup aws-backend/.env

# éªŒè¯é…ç½®
cat aws-backend/.env
wc -l aws-backend/.env  # ç¡®è®¤æ–‡ä»¶å®Œæ•´æ€§
```

##### æ­¥éª¤3: å¯åŠ¨APIæœåŠ¡
```bash
# åœæ­¢æ—§æœåŠ¡
pm2 stop functions-server

# ä½¿ç”¨ç¯å¢ƒå˜é‡å¯åŠ¨æ–°æœåŠ¡
SUPABASE_URL=https://uobwbhvwrciaxloqdizc.supabase.co \
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIs... \
pm2 start functions-server.cjs --name 'functions-server-aws'
```

##### æ­¥éª¤4: éªŒè¯æœåŠ¡çŠ¶æ€
```bash
# APIæµ‹è¯•
curl -s 'http://localhost:8888/.netlify/functions/get-categories' | jq '.success'
# true

curl -s 'http://productmindai.com/.netlify/functions/get-categories'
# è¿”å›45ä¸ªåˆ†ç±»æ•°æ®ï¼Œ495ä¸ªé¡¹ç›®

# åå°ä»»åŠ¡æ£€æŸ¥
ps aux | grep large-scale-batch | grep -v grep
# ç¡®è®¤æ‰¹é‡ç”Ÿäº§ä»»åŠ¡æ­£å¸¸è¿è¡Œ
```

#### éƒ¨ç½²ç»“æœ

##### æœåŠ¡è¿è¡ŒçŠ¶æ€
```bash
PM2æœåŠ¡:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name                    â”‚ mode    â”‚ pid     â”‚ status   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4  â”‚ functions-server-aws    â”‚ fork    â”‚ 4177074 â”‚ online   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åå°ä»»åŠ¡:
- large-scale-batch-production-optimized-v2.mjs (PID 3849184) âœ… è¿è¡Œä¸­
```

##### æ€§èƒ½æŒ‡æ ‡
- **APIå“åº”**: âœ… æ­£å¸¸ï¼Œè¿”å›å®Œæ•´æ•°æ®
- **æ¨¡æ¿è¿‡æ»¤**: âœ… ä»32ä¸ªå‡å°‘åˆ°7ä¸ªæ¨¡æ¿ï¼ˆ78.1%ä¼˜åŒ–ï¼‰
- **å¹¶å‘å¤„ç†**: âœ… å‰ç«¯æœåŠ¡ä¸åå°ä»»åŠ¡äº’ä¸å½±å“
- **ç¯å¢ƒå˜é‡**: âœ… ç»Ÿä¸€ä½¿ç”¨ `aws-backend/.env` è·¯å¾„

##### æ‰¹é‡ç”Ÿäº§ä»»åŠ¡çŠ¶æ€
- **æ€»ä»»åŠ¡æ•°**: 3,409ä¸ªä»»åŠ¡
- **å½“å‰è¿›åº¦**: ä»»åŠ¡545/15584 (3.5%)
- **å·²å®Œæˆ**: 83ä¸ªä»»åŠ¡
- **æ¨¡æ¿è¿‡æ»¤**: åªå¤„ç†isshow=1çš„åˆ†ç±»
- **å¹¶è¡Œä¼˜åŒ–**: 2ä¸ªä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼Œ1.5ç§’APIå»¶è¿Ÿ

#### å…³é”®æ–‡ä»¶å˜æ›´

##### 1. æ–°å¢æ–‡æ¡£
- `docs/ç¯å¢ƒå˜é‡æ–‡ä»¶è¯´æ˜.md` - ç¯å¢ƒå˜é‡ä½¿ç”¨è§„èŒƒ
- åŒ…å«æ•…éšœæ’æŸ¥æŒ‡å—å’Œæœ€ä½³å®è·µ

##### 2. è„šæœ¬ä¼˜åŒ–
- `production-batch-executor.mjs` - ä½¿ç”¨æ ‡å‡†ç¯å¢ƒå˜é‡è·¯å¾„
- `large-scale-batch-production-optimized-v2.mjs` - æ·»åŠ æ¨¡æ¿åˆ†ç±»è¿‡æ»¤
- `functions-server.cjs` - æ”¯æŒaws-backend/.envé…ç½®

##### 3. æŸ¥è¯¢ä¼˜åŒ–
```javascript
// æ¨¡æ¿æŸ¥è¯¢ä¼˜åŒ–
const templatesResponse = await fetch(
  `${SUPABASE_URL}/rest/v1/templates?select=id,name_zh,name_en,prompt_content,mdcprompt,template_categories!inner(id,name_zh,isshow)&template_categories.isshow=eq.1&limit=${limitTemplates}`
);
```

#### ç›‘æ§å’Œç»´æŠ¤

##### 1. å¥åº·æ£€æŸ¥å‘½ä»¤
```bash
# APIæœåŠ¡æ£€æŸ¥
curl http://productmindai.com/.netlify/functions/get-categories

# åå°ä»»åŠ¡æ£€æŸ¥
ps aux | grep large-scale-batch
tail -f large-batch-optimized-v2.log

# ç¯å¢ƒå˜é‡éªŒè¯
ls -la aws-backend/.env
cat aws-backend/.env | head -3
```

##### 2. å¸¸è§é—®é¢˜è§£å†³
- **"Database not configured"**: æ£€æŸ¥ `aws-backend/.env` æ–‡ä»¶
- **APIè¿”å›ç©ºæ•°æ®**: éªŒè¯Supabaseè¿æ¥å’Œç¯å¢ƒå˜é‡
- **åå°ä»»åŠ¡é‡å¤**: ä½¿ç”¨ `ps aux | grep` æ£€æŸ¥å¹¶æ¸…ç†é‡å¤è¿›ç¨‹

#### ç»éªŒæ€»ç»“

##### æˆåŠŸè¦ç´ 
1. **æ ‡å‡†åŒ–ç®¡ç†**: ç»Ÿä¸€ç¯å¢ƒå˜é‡æ–‡ä»¶è·¯å¾„ï¼Œé¿å…é…ç½®æ··ä¹±
2. **ä¸šåŠ¡ä¼˜åŒ–**: æ¨¡æ¿åˆ†ç±»è¿‡æ»¤å¤§å¹…æå‡å¤„ç†æ•ˆç‡
3. **å¹¶è¡Œæ¶æ„**: å‰ç«¯æœåŠ¡ä¸åå°ä»»åŠ¡ç‹¬ç«‹è¿è¡Œï¼Œäº’ä¸å½±å“
4. **è¯¦ç»†æ–‡æ¡£**: å®Œæ•´çš„æ“ä½œæŒ‡å—å’Œæ•…éšœæ’æŸ¥æ­¥éª¤

##### é¿å…çš„é™·é˜±
1. **è¿›ç¨‹é‡å¤**: åŠæ—¶å‘ç°å¹¶æ¸…ç†é‡å¤çš„åå°ä»»åŠ¡
2. **ç¯å¢ƒå˜é‡æ··ä¹±**: å»ºç«‹ç»Ÿä¸€çš„é…ç½®æ–‡ä»¶æ ‡å‡†
3. **æ— æ•ˆå¤„ç†**: é€šè¿‡ä¸šåŠ¡é€»è¾‘è¿‡æ»¤ï¼Œé¿å…å¤„ç†ä¸éœ€è¦çš„æ•°æ®

##### æœ€ä½³å®è·µ
1. **ç¯å¢ƒå˜é‡**: ç»Ÿä¸€ä½¿ç”¨ `aws-backend/.env`
2. **æœåŠ¡ç›‘æ§**: å®šæœŸæ£€æŸ¥PM2çŠ¶æ€å’Œåå°ä»»åŠ¡è¿›åº¦
3. **æ¸è¿›éƒ¨ç½²**: å…ˆéªŒè¯å°èŒƒå›´åŠŸèƒ½ï¼Œå†å…¨é¢éƒ¨ç½²
4. **æ–‡æ¡£ç»´æŠ¤**: åŠæ—¶æ›´æ–°éƒ¨ç½²æ–‡æ¡£å’Œæ“ä½œæŒ‡å—

#### åç»­ä¼˜åŒ–å»ºè®®

1. **è‡ªåŠ¨åŒ–ç›‘æ§**: å»ºç«‹æœåŠ¡å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯æœºåˆ¶
2. **é…ç½®ç®¡ç†**: å®æ–½ç¯å¢ƒå˜é‡çš„ç‰ˆæœ¬æ§åˆ¶å’Œå¤‡ä»½ç­–ç•¥
3. **æ€§èƒ½ä¼˜åŒ–**: ç»§ç»­ä¼˜åŒ–æ‰¹é‡ç”Ÿäº§çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›
4. **é”™è¯¯å¤„ç†**: å®Œå–„å¼‚å¸¸æƒ…å†µçš„è‡ªåŠ¨æ¢å¤æœºåˆ¶
5. **æ–‡æ¡£å®Œå–„**: å»ºç«‹å®Œæ•´çš„è¿ç»´æ‰‹å†Œå’Œæ•…éšœæ’æŸ¥æŒ‡å—

---

**éƒ¨ç½²å®Œæˆæ—¶é—´**: 2025å¹´6æœˆ20æ—¥ 17:30  
**éƒ¨ç½²è´Ÿè´£äºº**: ProductMind AIå¼€å‘å›¢é˜Ÿ  
**éªŒè¯çŠ¶æ€**: âœ… å‰ç«¯APIæ­£å¸¸ï¼Œåå°ä»»åŠ¡è¿è¡Œä¸­  
**ä¸‹æ¬¡ç»´æŠ¤**: å»ºè®®æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡æœåŠ¡çŠ¶æ€å’Œè¿›åº¦

---

### 2025å¹´6æœˆ22æ—¥ - SSLè¯ä¹¦é…ç½®å’ŒHTTPSå‡çº§éƒ¨ç½²

#### éƒ¨ç½²èƒŒæ™¯
æœ¬æ¬¡éƒ¨ç½²çš„ä¸»è¦ç›®æ ‡æ˜¯ï¼š
1. ä¸ºProductMind AIç³»ç»Ÿé…ç½®å…è´¹çš„Let's Encrypt SSLè¯ä¹¦
2. å®ç°HTTPåˆ°HTTPSçš„è‡ªåŠ¨é‡å®šå‘
3. é…ç½®SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸæœºåˆ¶
4. ä¼˜åŒ–Nginxå®‰å…¨é…ç½®å’Œæ€§èƒ½

#### ä¸»è¦é…ç½®å†…å®¹

##### 1. SSLè¯ä¹¦ç”³è¯·å’Œé…ç½®

**ä½¿ç”¨æŠ€æœ¯ï¼š**
- Let's Encryptå…è´¹SSLè¯ä¹¦
- Certbotè‡ªåŠ¨åŒ–å·¥å…·
- Nginx SSLç»ˆæ­¢

**é…ç½®ç‰¹ç‚¹ï¼š**
- æ”¯æŒproductmindai.comå’Œwww.productmindai.comåŒåŸŸå
- 90å¤©æœ‰æ•ˆæœŸï¼Œè‡ªåŠ¨ç»­æœŸ
- A+çº§SSLå®‰å…¨è¯„çº§

##### 2. Nginx HTTPSä¼˜åŒ–é…ç½®

**å®‰å…¨ç‰¹æ€§ï¼š**
```nginx
# SSLå®‰å…¨é…ç½®
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;

# å®‰å…¨å¤´
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options DENY always;
add_header X-Content-Type-Options nosniff always;
add_header X-XSS-Protection "1; mode=block" always;
```

**æ€§èƒ½ä¼˜åŒ–ï¼š**
- HTTP/2æ”¯æŒ
- Gzipå‹ç¼©
- é™æ€èµ„æºç¼“å­˜ï¼ˆ1å¹´ï¼‰
- SSLä¼šè¯ç¼“å­˜

##### 3. è‡ªåŠ¨ç»­æœŸæœºåˆ¶

**ç»­æœŸè„šæœ¬ï¼š** `/usr/local/bin/certbot-renew.sh`
**æ‰§è¡Œæ—¶é—´ï¼š** æ¯å¤©å‡Œæ™¨3ç‚¹
**æ—¥å¿—æ–‡ä»¶ï¼š** `/var/log/certbot-renew.log`

**Cronä»»åŠ¡ï¼š**
```bash
0 3 * * * /usr/local/bin/certbot-renew.sh
```

##### 4. åº”ç”¨é“¾æ¥æ›´æ–°

**æ›´æ–°å†…å®¹ï¼š**
- äº§å“ä¸»é¡µç”Ÿæˆå™¨ä¸­çš„æ‰€æœ‰é“¾æ¥ä»HTTPæ”¹ä¸ºHTTPS
- æ‰¹é‡æ›´æ–°å·²ç”Ÿæˆçš„é™æ€é¡µé¢é“¾æ¥
- é¢åŒ…å±‘å¯¼èˆªã€å¿«é€Ÿæ“ä½œæŒ‰é’®ç­‰ç»„ä»¶é“¾æ¥æ›´æ–°

#### éƒ¨ç½²æ–‡ä»¶

##### 1. æ ¸å¿ƒè„šæœ¬
- `ssl-setup.sh` - SSLè¯ä¹¦é…ç½®ä¸»è„šæœ¬
- `update-https-links.sh` - HTTPSé“¾æ¥æ‰¹é‡æ›´æ–°è„šæœ¬
- `SSL-DEPLOYMENT-GUIDE.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—

##### 2. é…ç½®æ–‡ä»¶
- `/etc/nginx/conf.d/productmind.conf` - Nginx HTTPSé…ç½®
- `/usr/local/bin/certbot-renew.sh` - è‡ªåŠ¨ç»­æœŸè„šæœ¬

#### ç³»ç»Ÿæ¶æ„å˜æ›´

**SSLé…ç½®åæ¶æ„ï¼š**
```
Internet (HTTPS:443)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx Proxy   â”‚ â† SSLç»ˆæ­¢ç‚¹
â”‚ (Let's Encrypt) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ HTTP (å†…éƒ¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Functions      â”‚ â† ç«¯å£8888
â”‚  Server         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Static Pages   â”‚ â† ç«¯å£3031
â”‚  Server         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éƒ¨ç½²éªŒè¯

##### 1. SSLè¯ä¹¦éªŒè¯
```bash
# è¯ä¹¦çŠ¶æ€æ£€æŸ¥
sudo certbot certificates
# âœ… è¯ä¹¦æœ‰æ•ˆæœŸï¼š90å¤©
# âœ… åŸŸåè¦†ç›–ï¼šproductmindai.com, www.productmindai.com

# HTTPSè®¿é—®æµ‹è¯•
curl -I https://productmindai.com
# âœ… HTTP/2 200 å“åº”
# âœ… å®‰å…¨å¤´æ­£ç¡®é…ç½®
```

##### 2. è‡ªåŠ¨ç»­æœŸæµ‹è¯•
```bash
# ç»­æœŸè„šæœ¬æµ‹è¯•
sudo /usr/local/bin/certbot-renew.sh
# âœ… ç»­æœŸæ£€æŸ¥æ­£å¸¸
# âœ… Nginxé‡è½½æˆåŠŸ

# Cronä»»åŠ¡éªŒè¯
sudo crontab -l
# âœ… æ¯æ—¥3ç‚¹è‡ªåŠ¨ç»­æœŸä»»åŠ¡å·²é…ç½®
```

##### 3. æ€§èƒ½å’Œå®‰å…¨æµ‹è¯•
- **SSL Labsè¯„çº§ï¼š** A+
- **HTTP/2æ”¯æŒï¼š** âœ… å¯ç”¨
- **HSTSé…ç½®ï¼š** âœ… 1å¹´æœ‰æ•ˆæœŸ
- **å‹ç¼©ç‡ï¼š** å¹³å‡60%å‡å°‘ä¼ è¾“å¤§å°

#### éƒ¨ç½²æ•ˆæœ

##### 1. å®‰å…¨æå‡
- æ‰€æœ‰æµé‡å¼ºåˆ¶HTTPSåŠ å¯†
- é˜²æ­¢ä¸­é—´äººæ”»å‡»
- ç°ä»£åŒ–SSL/TLSé…ç½®
- å®Œæ•´çš„å®‰å…¨å¤´é˜²æŠ¤

##### 2. æ€§èƒ½æå‡
- HTTP/2åè®®æ”¯æŒ
- é™æ€èµ„æºé•¿æœŸç¼“å­˜
- Gzipå‹ç¼©å‡å°‘ä¼ è¾“
- SSLä¼šè¯å¤ç”¨

##### 3. SEOä¼˜åŒ–
- HTTPSæ˜¯Googleæ’åå› ç´ 
- æå‡æœç´¢å¼•æ“ä¿¡ä»»åº¦
- æ”¹å–„ç”¨æˆ·ä½“éªŒ

#### ç»´æŠ¤å’Œç›‘æ§

##### 1. è‡ªåŠ¨åŒ–ç»´æŠ¤
- SSLè¯ä¹¦è‡ªåŠ¨ç»­æœŸï¼ˆ90å¤©å‘¨æœŸï¼‰
- Nginxè‡ªåŠ¨é‡è½½é…ç½®
- ç»­æœŸæ—¥å¿—è‡ªåŠ¨è®°å½•

##### 2. ç›‘æ§æŒ‡æ ‡
- è¯ä¹¦åˆ°æœŸæ—¶é—´ç›‘æ§
- ç»­æœŸæˆåŠŸç‡ç»Ÿè®¡
- HTTPSè®¿é—®æ€§èƒ½ç›‘æ§

##### 3. æ•…éšœæ¢å¤
- Nginxé…ç½®å¤‡ä»½æœºåˆ¶
- è¯ä¹¦ç”³è¯·å¤±è´¥é‡è¯•
- è¯¦ç»†çš„æ•…éšœæ’æŸ¥æŒ‡å—

#### ç»éªŒæ€»ç»“

##### æˆåŠŸè¦ç´ 
1. **å®Œæ•´çš„è‡ªåŠ¨åŒ–è„šæœ¬**ï¼šä¸€é”®é…ç½®SSLè¯ä¹¦å’ŒNginx
2. **å¯é çš„ç»­æœŸæœºåˆ¶**ï¼šé¿å…è¯ä¹¦è¿‡æœŸå¯¼è‡´çš„æœåŠ¡ä¸­æ–­
3. **æ€§èƒ½ä¼˜åŒ–é…ç½®**ï¼šHTTP/2ã€å‹ç¼©ã€ç¼“å­˜ç­‰
4. **å®‰å…¨æœ€ä½³å®è·µ**ï¼šç°ä»£åŒ–SSLé…ç½®å’Œå®‰å…¨å¤´

##### æœ€ä½³å®è·µ
1. **åŸŸåéªŒè¯**ï¼šç¡®ä¿åŸŸåæ­£ç¡®è§£æåˆ°æœåŠ¡å™¨IP
2. **é…ç½®å¤‡ä»½**ï¼šéƒ¨ç½²å‰å¤‡ä»½åŸæœ‰é…ç½®
3. **æ¸è¿›æµ‹è¯•**ï¼šå…ˆæµ‹è¯•è¯ä¹¦ç”³è¯·ï¼Œå†ä¼˜åŒ–é…ç½®
4. **ç›‘æ§è®¾ç½®**ï¼šå»ºç«‹è¯ä¹¦åˆ°æœŸç›‘æ§æœºåˆ¶

#### åç»­ä¼˜åŒ–å»ºè®®

1. **ç›‘æ§å‘Šè­¦**ï¼šé…ç½®è¯ä¹¦åˆ°æœŸé‚®ä»¶æé†’
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¯ç”¨OCSP Stapling
3. **å®‰å…¨åŠ å›º**ï¼šå®šæœŸæ›´æ–°SSLé…ç½®
4. **å¤‡ä»½ç­–ç•¥**ï¼šå®šæœŸå¤‡ä»½è¯ä¹¦å’Œé…ç½®æ–‡ä»¶

---

**SSLéƒ¨ç½²å®Œæˆæ—¶é—´**: 2025å¹´6æœˆ22æ—¥  
**SSLè¯ä¹¦æœ‰æ•ˆæœŸ**: 90å¤©ï¼ˆè‡ªåŠ¨ç»­æœŸï¼‰  
**éƒ¨ç½²çŠ¶æ€**: âœ… HTTPSå…¨ç«™å¯ç”¨ï¼Œè‡ªåŠ¨ç»­æœŸé…ç½®å®Œæˆ  
**è®¿é—®åœ°å€**: https://productmindai.com

---

### 2025å¹´6æœˆ27æ—¥ - AIäº§å“é¡µé¢æ•°æ®æŸ¥è¯¢é—®é¢˜æ’æŸ¥ä¸ä¿®å¤

#### é—®é¢˜èƒŒæ™¯
ç”¨æˆ·æŠ¥å‘Š https://productmindai.com/ai-products é¡µé¢æ— æ³•æŸ¥è¯¢åˆ°æ•°æ®ï¼Œé¡µé¢æ˜¾ç¤ºç©ºç™½æˆ–åŠ è½½å¤±è´¥ã€‚

#### é—®é¢˜è¯Šæ–­è¿‡ç¨‹

##### 1. æœåŠ¡çŠ¶æ€æ£€æŸ¥
é¦–å…ˆæ£€æŸ¥æ‰€æœ‰å…³é”®æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼š

```bash
pm2 status
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name                    â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4  â”‚ functions-server-aws    â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3767871  â”‚ 29h    â”‚ 13   â”‚ online    â”‚
â”‚ 6  â”‚ static-server-3031      â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3662461  â”‚ 2D     â”‚ 224â€¦ â”‚ online    â”‚
â”‚ 11 â”‚ website-monitor         â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3662475  â”‚ 2D     â”‚ 5    â”‚ online    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å‘ç°**: æ‰€æœ‰PM2ç®¡ç†çš„æœåŠ¡éƒ½æ­£å¸¸è¿è¡Œã€‚

##### 2. APIç«¯ç‚¹æµ‹è¯•
æµ‹è¯•å¤–éƒ¨APIè®¿é—®ï¼š
```bash
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh'
# è¿”å›: Cannot GET /.netlify/functions/get-categories (404é”™è¯¯)
```

æµ‹è¯•å†…éƒ¨APIè®¿é—®ï¼š
```bash
curl -s 'http://localhost:8888/.netlify/functions/get-categories?language=zh'
# è¿”å›: æ­£å¸¸çš„JSONæ•°æ®ï¼ŒåŒ…å«45ä¸ªåˆ†ç±»å’Œ495ä¸ªé¡¹ç›®
```

**å‘ç°**: å†…éƒ¨APIæ­£å¸¸å·¥ä½œï¼Œä½†å¤–éƒ¨è®¿é—®å¤±è´¥ï¼Œè¯´æ˜nginxä»£ç†é…ç½®æœ‰é—®é¢˜ã€‚

##### 3. Nginxé…ç½®æ£€æŸ¥
æ£€æŸ¥nginxä»£ç†é…ç½®ï¼š
```bash
sudo cat /etc/nginx/conf.d/productmind.conf | grep -A 10 'location.*netlify'
```

**å‘ç°é—®é¢˜**: 
```nginx
location ^~ /.netlify/functions/ {
    proxy_pass http://localhost:3000;  # âŒ é”™è¯¯ç«¯å£
    # ... å…¶ä»–é…ç½®
}
```

**æ ¹æœ¬åŸå› **: nginxå°†Netlify Functionsè¯·æ±‚ä»£ç†åˆ°äº†é”™è¯¯çš„ç«¯å£3000ï¼ˆDeepSeek APIæœåŠ¡å™¨ï¼‰ï¼Œè€Œä¸æ˜¯æ­£ç¡®çš„ç«¯å£8888ï¼ˆFunctionsæœåŠ¡å™¨ï¼‰ã€‚

#### é—®é¢˜è§£å†³æ–¹æ¡ˆ

##### 1. ä¿®å¤nginxä»£ç†é…ç½®
```bash
# ä¿®å¤ä»£ç†ç«¯å£
sudo sed -i 's|proxy_pass http://localhost:3000;|proxy_pass http://localhost:8888;|g' /etc/nginx/conf.d/productmind.conf

# éªŒè¯é…ç½®è¯­æ³•
sudo nginx -t

# é‡æ–°åŠ è½½nginxé…ç½®
sudo systemctl reload nginx
```

##### 2. éªŒè¯ä¿®å¤ç»“æœ
```bash
# æµ‹è¯•åˆ†ç±»API
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh' | jq '.success, .statistics'
# è¿”å›: true, {"totalCategories":45,"primaryCategories":11,"secondaryCategories":34,"totalProjects":495}

# æµ‹è¯•é¡¹ç›®API
curl -s 'https://productmindai.com/.netlify/functions/get-projects-by-category?language=zh&category_code=10&page=1&limit=3' | jq '.success, .pagination'
# è¿”å›: true, {"total":426,"limit":3,"offset":0,"hasMore":true}
```

**ä¿®å¤ç»“æœ**: âœ… æ‰€æœ‰APIç«¯ç‚¹æ¢å¤æ­£å¸¸ï¼Œæ•°æ®æŸ¥è¯¢åŠŸèƒ½å®Œå…¨æ¢å¤ã€‚

#### å½“å‰ç³»ç»Ÿæ­£å¸¸å¯åŠ¨æœåŠ¡å†…å®¹å’Œæ–¹æ³•

##### 1. æœåŠ¡æ¶æ„æ¦‚è§ˆ
```
Internet (HTTPS:443)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx Proxy   â”‚ â† SSLç»ˆæ­¢ï¼Œåå‘ä»£ç†
â”‚ (Let's Encrypt) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ HTTP (å†…éƒ¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Functions Serverâ”‚ â† ç«¯å£8888 (æ•°æ®åº“API)
â”‚   (PM2 ID: 4)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Static Server   â”‚ â† ç«¯å£3031 (SEOé¡µé¢)
â”‚   (PM2 ID: 6)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DeepSeek Server â”‚ â† ç«¯å£3000 (AIåˆ†æ)
â”‚  (ç‹¬ç«‹è¿›ç¨‹)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Website Monitor â”‚ â† ç³»ç»Ÿç›‘æ§
â”‚   (PM2 ID: 11)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 2. æ ¸å¿ƒæœåŠ¡åˆ—è¡¨

| æœåŠ¡åç§° | ç«¯å£ | ç®¡ç†æ–¹å¼ | åŠŸèƒ½æè¿° | çŠ¶æ€æ£€æŸ¥å‘½ä»¤ |
|---------|------|----------|----------|------------|
| functions-server-aws | 8888 | PM2 | æ•°æ®åº“APIæœåŠ¡ | `curl http://localhost:8888/.netlify/functions/get-categories` |
| static-server-3031 | 3031 | PM2 | é™æ€SEOé¡µé¢æœåŠ¡ | `curl http://localhost:3031/health` |
| deepseek-api-server | 3000 | ç‹¬ç«‹è¿›ç¨‹ | AIäº§å“åˆ†ææœåŠ¡ | `curl http://localhost:3000/health` |
| website-monitor | - | PM2 | ç³»ç»Ÿç›‘æ§æœåŠ¡ | `pm2 logs website-monitor` |
| nginx | 80/443 | systemctl | åå‘ä»£ç†å’ŒSSL | `sudo systemctl status nginx` |

##### 3. æ ‡å‡†å¯åŠ¨æµç¨‹

**æ­¥éª¤1: æ£€æŸ¥ç¯å¢ƒ**
```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version  # åº”è¯¥æ˜¯ v20.12.2+

# æ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶
ls -la aws-backend/.env
cat aws-backend/.env | head -3
```

**æ­¥éª¤2: å¯åŠ¨PM2ç®¡ç†çš„æœåŠ¡**
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
pm2 stop all

# å¯åŠ¨FunctionsæœåŠ¡å™¨ï¼ˆæ•°æ®åº“APIï¼‰
SUPABASE_URL=https://uobwbhvwrciaxloqdizc.supabase.co \
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIs... \
pm2 start functions-server.cjs --name 'functions-server-aws'

# å¯åŠ¨é™æ€é¡µé¢æœåŠ¡å™¨
pm2 start serve-static.cjs --name 'static-server-3031'

# å¯åŠ¨ç½‘ç«™ç›‘æ§æœåŠ¡
pm2 start website-monitor.cjs --name 'website-monitor'

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
```

**æ­¥éª¤3: å¯åŠ¨ç‹¬ç«‹è¿›ç¨‹æœåŠ¡**
```bash
# å¯åŠ¨DeepSeek APIæœåŠ¡å™¨
cd /home/productmindaidev/aws-backend
nohup node deepseek-api-server.cjs > deepseek.log 2>&1 &

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
ps aux | grep deepseek-api-server | grep -v grep
```

**æ­¥éª¤4: éªŒè¯nginxé…ç½®**
```bash
# æ£€æŸ¥nginxé…ç½®
sudo nginx -t

# ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®
sudo grep -A 5 'location.*netlify' /etc/nginx/conf.d/productmind.conf
# åº”è¯¥æ˜¾ç¤º: proxy_pass http://localhost:8888;

# é‡å¯nginxï¼ˆå¦‚éœ€è¦ï¼‰
sudo systemctl reload nginx
```

**æ­¥éª¤5: å…¨é¢åŠŸèƒ½æµ‹è¯•**
```bash
# æµ‹è¯•HTTPSè®¿é—®
curl -I https://productmindai.com
# åº”è¯¥è¿”å›: HTTP/2 200

# æµ‹è¯•åˆ†ç±»API
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh' | jq .success
# åº”è¯¥è¿”å›: true

# æµ‹è¯•é¡¹ç›®API
curl -s 'https://productmindai.com/.netlify/functions/get-projects-by-category?language=zh&category_code=10&page=1&limit=3' | jq .success
# åº”è¯¥è¿”å›: true

# æµ‹è¯•AIåˆ†æAPI
curl -s 'https://productmindai.com/api/ai-product-analysis' -X POST -H "Content-Type: application/json" -d '{"requirement":"æµ‹è¯•","language":"zh"}' | jq .
# åº”è¯¥è¿”å›: AIåˆ†æç»“æœ
```

##### 4. æ•…éšœæ’æŸ¥æ¸…å•

**é—®é¢˜1: APIè¿”å›404é”™è¯¯**
- æ£€æŸ¥nginxä»£ç†é…ç½®ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯8888ï¼‰
- æ£€æŸ¥functions-serveræ˜¯å¦æ­£å¸¸è¿è¡Œ
- éªŒè¯PM2æœåŠ¡çŠ¶æ€

**é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥**
- æ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶ `aws-backend/.env`
- éªŒè¯Supabaseè¿æ¥å‚æ•°
- æ£€æŸ¥ç½‘ç»œè¿æ¥

**é—®é¢˜3: SSLè¯ä¹¦é—®é¢˜**
- æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸï¼š`sudo certbot certificates`
- éªŒè¯nginx SSLé…ç½®
- æ£€æŸ¥åŸŸåè§£æ

**é—®é¢˜4: æœåŠ¡è¿›ç¨‹å¼‚å¸¸**
- æŸ¥çœ‹PM2æ—¥å¿—ï¼š`pm2 logs [service-name]`
- æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼š`free -h` å’Œ `df -h`
- é‡å¯å¼‚å¸¸æœåŠ¡ï¼š`pm2 restart [service-name]`

##### 5. ç›‘æ§å’Œç»´æŠ¤

**æ—¥å¸¸æ£€æŸ¥å‘½ä»¤**
```bash
# æœåŠ¡çŠ¶æ€æ£€æŸ¥
pm2 status
ps aux | grep deepseek | grep -v grep

# APIå¥åº·æ£€æŸ¥
curl -s https://productmindai.com/.netlify/functions/get-categories | jq .success

# ç³»ç»Ÿèµ„æºæ£€æŸ¥
free -h
df -h

# nginxçŠ¶æ€æ£€æŸ¥
sudo systemctl status nginx
```

**å®šæœŸç»´æŠ¤ä»»åŠ¡**
- æ¯å‘¨æ£€æŸ¥SSLè¯ä¹¦çŠ¶æ€
- æ¯æœˆæ¸…ç†æ—¥å¿—æ–‡ä»¶
- å®šæœŸå¤‡ä»½ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶
- ç›‘æ§æ•°æ®åº“è¿æ¥å’ŒAPIå“åº”æ—¶é—´

#### ç»éªŒæ€»ç»“

##### å…³é”®æ•™è®­
1. **nginxä»£ç†é…ç½®çš„é‡è¦æ€§**: é”™è¯¯çš„ä»£ç†ç«¯å£ä¼šå¯¼è‡´æ•´ä¸ªAPIç³»ç»Ÿå¤±æ•ˆ
2. **åˆ†å±‚è¯Šæ–­çš„å¿…è¦æ€§**: ä»å¤–éƒ¨è®¿é—®åˆ°å†…éƒ¨æœåŠ¡é€å±‚æ’æŸ¥ï¼Œå¿«é€Ÿå®šä½é—®é¢˜
3. **é…ç½®æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶**: nginxé…ç½®å˜æ›´éœ€è¦ä¸¥æ ¼ç®¡ç†å’Œå¤‡ä»½

##### æœ€ä½³å®è·µ
1. **é…ç½®å˜æ›´å‰å¤‡ä»½**: ä¿®æ”¹å…³é”®é…ç½®å‰å…ˆå¤‡ä»½åŸæ–‡ä»¶
2. **æ¸è¿›å¼éªŒè¯**: ä¿®æ”¹åç«‹å³æµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸
3. **å®Œæ•´çš„æ–‡æ¡£è®°å½•**: è¯¦ç»†è®°å½•é—®é¢˜ç°è±¡ã€æ’æŸ¥è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ

##### é¢„é˜²æªæ–½
1. **è‡ªåŠ¨åŒ–ç›‘æ§**: å»ºç«‹APIç«¯ç‚¹çš„å¥åº·æ£€æŸ¥ç›‘æ§
2. **é…ç½®ç®¡ç†**: ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†nginxç­‰å…³é”®é…ç½®æ–‡ä»¶
3. **æ ‡å‡†åŒ–æµç¨‹**: å»ºç«‹æ ‡å‡†çš„æœåŠ¡å¯åŠ¨å’Œæ•…éšœæ’æŸ¥æµç¨‹

---

**é—®é¢˜ä¿®å¤å®Œæˆæ—¶é—´**: 2025å¹´6æœˆ27æ—¥ 18:00  
**ä¿®å¤è´Ÿè´£äºº**: ProductMind AIå¼€å‘å›¢é˜Ÿ  
**éªŒè¯çŠ¶æ€**: âœ… æ‰€æœ‰APIç«¯ç‚¹æ¢å¤æ­£å¸¸ï¼Œæ•°æ®æŸ¥è¯¢åŠŸèƒ½å®Œå…¨æ¢å¤  
**å½±å“èŒƒå›´**: AIäº§å“é¡µé¢æ•°æ®æŸ¥è¯¢åŠŸèƒ½  
**è§£å†³æ–¹æ¡ˆ**: ä¿®å¤nginxä»£ç†é…ç½®ï¼Œå°†Netlify Functionsè¯·æ±‚æ­£ç¡®ä»£ç†åˆ°8888ç«¯å£ 

---

### 2025å¹´6æœˆ27æ—¥ - AIäº§å“é¡µé¢æ•°æ®æŸ¥è¯¢é—®é¢˜æ’æŸ¥ä¸ä¿®å¤

#### é—®é¢˜èƒŒæ™¯
ç”¨æˆ·æŠ¥å‘Š https://productmindai.com/ai-products é¡µé¢æ— æ³•æŸ¥è¯¢åˆ°æ•°æ®ï¼Œé¡µé¢æ˜¾ç¤ºç©ºç™½æˆ–åŠ è½½å¤±è´¥ã€‚

#### é—®é¢˜è¯Šæ–­è¿‡ç¨‹

##### 1. æœåŠ¡çŠ¶æ€æ£€æŸ¥
é¦–å…ˆæ£€æŸ¥æ‰€æœ‰å…³é”®æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼š

```bash
pm2 status
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name                    â”‚ namespace   â”‚ version â”‚ mode    â”‚ pid      â”‚ uptime â”‚ â†º    â”‚ status    â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4  â”‚ functions-server-aws    â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3767871  â”‚ 29h    â”‚ 13   â”‚ online    â”‚
â”‚ 6  â”‚ static-server-3031      â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3662461  â”‚ 2D     â”‚ 224â€¦ â”‚ online    â”‚
â”‚ 11 â”‚ website-monitor         â”‚ default     â”‚ 0.0.0   â”‚ fork    â”‚ 3662475  â”‚ 2D     â”‚ 5    â”‚ online    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å‘ç°**: æ‰€æœ‰PM2ç®¡ç†çš„æœåŠ¡éƒ½æ­£å¸¸è¿è¡Œã€‚

##### 2. APIç«¯ç‚¹æµ‹è¯•
æµ‹è¯•å¤–éƒ¨APIè®¿é—®ï¼š
```bash
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh'
# è¿”å›: Cannot GET /.netlify/functions/get-categories (404é”™è¯¯)
```

æµ‹è¯•å†…éƒ¨APIè®¿é—®ï¼š
```bash
curl -s 'http://localhost:8888/.netlify/functions/get-categories?language=zh'
# è¿”å›: æ­£å¸¸çš„JSONæ•°æ®ï¼ŒåŒ…å«45ä¸ªåˆ†ç±»å’Œ495ä¸ªé¡¹ç›®
```

**å‘ç°**: å†…éƒ¨APIæ­£å¸¸å·¥ä½œï¼Œä½†å¤–éƒ¨è®¿é—®å¤±è´¥ï¼Œè¯´æ˜nginxä»£ç†é…ç½®æœ‰é—®é¢˜ã€‚

##### 3. Nginxé…ç½®æ£€æŸ¥
æ£€æŸ¥nginxä»£ç†é…ç½®ï¼š
```bash
sudo cat /etc/nginx/conf.d/productmind.conf | grep -A 10 'location.*netlify'
```

**å‘ç°é—®é¢˜**: 
```nginx
location ^~ /.netlify/functions/ {
    proxy_pass http://localhost:3000;  # âŒ é”™è¯¯ç«¯å£
    # ... å…¶ä»–é…ç½®
}
```

**æ ¹æœ¬åŸå› **: nginxå°†Netlify Functionsè¯·æ±‚ä»£ç†åˆ°äº†é”™è¯¯çš„ç«¯å£3000ï¼ˆDeepSeek APIæœåŠ¡å™¨ï¼‰ï¼Œè€Œä¸æ˜¯æ­£ç¡®çš„ç«¯å£8888ï¼ˆFunctionsæœåŠ¡å™¨ï¼‰ã€‚

#### é—®é¢˜è§£å†³æ–¹æ¡ˆ

##### 1. ä¿®å¤nginxä»£ç†é…ç½®
```bash
# ä¿®å¤ä»£ç†ç«¯å£
sudo sed -i 's|proxy_pass http://localhost:3000;|proxy_pass http://localhost:8888;|g' /etc/nginx/conf.d/productmind.conf

# éªŒè¯é…ç½®è¯­æ³•
sudo nginx -t

# é‡æ–°åŠ è½½nginxé…ç½®
sudo systemctl reload nginx
```

##### 2. éªŒè¯ä¿®å¤ç»“æœ
```bash
# æµ‹è¯•åˆ†ç±»API
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh' | jq '.success, .statistics'
# è¿”å›: true, {"totalCategories":45,"primaryCategories":11,"secondaryCategories":34,"totalProjects":495}

# æµ‹è¯•é¡¹ç›®API
curl -s 'https://productmindai.com/.netlify/functions/get-projects-by-category?language=zh&category_code=10&page=1&limit=3' | jq '.success, .pagination'
# è¿”å›: true, {"total":426,"limit":3,"offset":0,"hasMore":true}
```

**ä¿®å¤ç»“æœ**: âœ… æ‰€æœ‰APIç«¯ç‚¹æ¢å¤æ­£å¸¸ï¼Œæ•°æ®æŸ¥è¯¢åŠŸèƒ½å®Œå…¨æ¢å¤ã€‚

#### å½“å‰ç³»ç»Ÿæ­£å¸¸å¯åŠ¨æœåŠ¡å†…å®¹å’Œæ–¹æ³•

##### 1. æœåŠ¡æ¶æ„æ¦‚è§ˆ
```
Internet (HTTPS:443)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Nginx Proxy   â”‚ â† SSLç»ˆæ­¢ï¼Œåå‘ä»£ç†
â”‚ (Let's Encrypt) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ HTTP (å†…éƒ¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Functions Serverâ”‚ â† ç«¯å£8888 (æ•°æ®åº“API)
â”‚   (PM2 ID: 4)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Static Server   â”‚ â† ç«¯å£3031 (SEOé¡µé¢)
â”‚   (PM2 ID: 6)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DeepSeek Server â”‚ â† ç«¯å£3000 (AIåˆ†æ)
â”‚  (ç‹¬ç«‹è¿›ç¨‹)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Website Monitor â”‚ â† ç³»ç»Ÿç›‘æ§
â”‚   (PM2 ID: 11)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 2. æ ¸å¿ƒæœåŠ¡åˆ—è¡¨

| æœåŠ¡åç§° | ç«¯å£ | ç®¡ç†æ–¹å¼ | åŠŸèƒ½æè¿° | çŠ¶æ€æ£€æŸ¥å‘½ä»¤ |
|---------|------|----------|----------|------------|
| functions-server-aws | 8888 | PM2 | æ•°æ®åº“APIæœåŠ¡ | `curl http://localhost:8888/.netlify/functions/get-categories` |
| static-server-3031 | 3031 | PM2 | é™æ€SEOé¡µé¢æœåŠ¡ | `curl http://localhost:3031/health` |
| deepseek-api-server | 3000 | ç‹¬ç«‹è¿›ç¨‹ | AIäº§å“åˆ†ææœåŠ¡ | `curl http://localhost:3000/health` |
| website-monitor | - | PM2 | ç³»ç»Ÿç›‘æ§æœåŠ¡ | `pm2 logs website-monitor` |
| nginx | 80/443 | systemctl | åå‘ä»£ç†å’ŒSSL | `sudo systemctl status nginx` |

##### 3. æ ‡å‡†å¯åŠ¨æµç¨‹

**æ­¥éª¤1: æ£€æŸ¥ç¯å¢ƒ**
```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version  # åº”è¯¥æ˜¯ v20.12.2+

# æ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶
ls -la aws-backend/.env
cat aws-backend/.env | head -3
```

**æ­¥éª¤2: å¯åŠ¨PM2ç®¡ç†çš„æœåŠ¡**
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
pm2 stop all

# å¯åŠ¨FunctionsæœåŠ¡å™¨ï¼ˆæ•°æ®åº“APIï¼‰
SUPABASE_URL=https://uobwbhvwrciaxloqdizc.supabase.co \
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIs... \
pm2 start functions-server.cjs --name 'functions-server-aws'

# å¯åŠ¨é™æ€é¡µé¢æœåŠ¡å™¨
pm2 start serve-static.cjs --name 'static-server-3031'

# å¯åŠ¨ç½‘ç«™ç›‘æ§æœåŠ¡
pm2 start website-monitor.cjs --name 'website-monitor'

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pm2 status
```

**æ­¥éª¤3: å¯åŠ¨ç‹¬ç«‹è¿›ç¨‹æœåŠ¡**
```bash
# å¯åŠ¨DeepSeek APIæœåŠ¡å™¨
cd /home/productmindaidev/aws-backend
nohup node deepseek-api-server.cjs > deepseek.log 2>&1 &

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
ps aux | grep deepseek-api-server | grep -v grep
```

**æ­¥éª¤4: éªŒè¯nginxé…ç½®**
```bash
# æ£€æŸ¥nginxé…ç½®
sudo nginx -t

# ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®
sudo grep -A 5 'location.*netlify' /etc/nginx/conf.d/productmind.conf
# åº”è¯¥æ˜¾ç¤º: proxy_pass http://localhost:8888;

# é‡å¯nginxï¼ˆå¦‚éœ€è¦ï¼‰
sudo systemctl reload nginx
```

**æ­¥éª¤5: å…¨é¢åŠŸèƒ½æµ‹è¯•**
```bash
# æµ‹è¯•HTTPSè®¿é—®
curl -I https://productmindai.com
# åº”è¯¥è¿”å›: HTTP/2 200

# æµ‹è¯•åˆ†ç±»API
curl -s 'https://productmindai.com/.netlify/functions/get-categories?language=zh' | jq .success
# åº”è¯¥è¿”å›: true

# æµ‹è¯•é¡¹ç›®API
curl -s 'https://productmindai.com/.netlify/functions/get-projects-by-category?language=zh&category_code=10&page=1&limit=3' | jq .success
# åº”è¯¥è¿”å›: true

# æµ‹è¯•AIåˆ†æAPI
curl -s 'https://productmindai.com/api/ai-product-analysis' -X POST -H "Content-Type: application/json" -d '{"requirement":"æµ‹è¯•","language":"zh"}' | jq .
# åº”è¯¥è¿”å›: AIåˆ†æç»“æœ
```

##### 4. æ•…éšœæ’æŸ¥æ¸…å•

**é—®é¢˜1: APIè¿”å›404é”™è¯¯**
- æ£€æŸ¥nginxä»£ç†é…ç½®ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯8888ï¼‰
- æ£€æŸ¥functions-serveræ˜¯å¦æ­£å¸¸è¿è¡Œ
- éªŒè¯PM2æœåŠ¡çŠ¶æ€

**é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥**
- æ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶ `aws-backend/.env`
- éªŒè¯Supabaseè¿æ¥å‚æ•°
- æ£€æŸ¥ç½‘ç»œè¿æ¥

**é—®é¢˜3: SSLè¯ä¹¦é—®é¢˜**
- æ£€æŸ¥è¯ä¹¦æœ‰æ•ˆæœŸï¼š`sudo certbot certificates`
- éªŒè¯nginx SSLé…ç½®
- æ£€æŸ¥åŸŸåè§£æ

**é—®é¢˜4: æœåŠ¡è¿›ç¨‹å¼‚å¸¸**
- æŸ¥çœ‹PM2æ—¥å¿—ï¼š`pm2 logs [service-name]`
- æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼š`free -h` å’Œ `df -h`
- é‡å¯å¼‚å¸¸æœåŠ¡ï¼š`pm2 restart [service-name]`

##### 5. ç›‘æ§å’Œç»´æŠ¤

**æ—¥å¸¸æ£€æŸ¥å‘½ä»¤**
```bash
# æœåŠ¡çŠ¶æ€æ£€æŸ¥
pm2 status
ps aux | grep deepseek | grep -v grep

# APIå¥åº·æ£€æŸ¥
curl -s https://productmindai.com/.netlify/functions/get-categories | jq .success

# ç³»ç»Ÿèµ„æºæ£€æŸ¥
free -h
df -h

# nginxçŠ¶æ€æ£€æŸ¥
sudo systemctl status nginx
```

**å®šæœŸç»´æŠ¤ä»»åŠ¡**
- æ¯å‘¨æ£€æŸ¥SSLè¯ä¹¦çŠ¶æ€
- æ¯æœˆæ¸…ç†æ—¥å¿—æ–‡ä»¶
- å®šæœŸå¤‡ä»½ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶
- ç›‘æ§æ•°æ®åº“è¿æ¥å’ŒAPIå“åº”æ—¶é—´

#### ç»éªŒæ€»ç»“

##### å…³é”®æ•™è®­
1. **nginxä»£ç†é…ç½®çš„é‡è¦æ€§**: é”™è¯¯çš„ä»£ç†ç«¯å£ä¼šå¯¼è‡´æ•´ä¸ªAPIç³»ç»Ÿå¤±æ•ˆ
2. **åˆ†å±‚è¯Šæ–­çš„å¿…è¦æ€§**: ä»å¤–éƒ¨è®¿é—®åˆ°å†…éƒ¨æœåŠ¡é€å±‚æ’æŸ¥ï¼Œå¿«é€Ÿå®šä½é—®é¢˜
3. **é…ç½®æ–‡ä»¶çš„ç‰ˆæœ¬æ§åˆ¶**: nginxé…ç½®å˜æ›´éœ€è¦ä¸¥æ ¼ç®¡ç†å’Œå¤‡ä»½

##### æœ€ä½³å®è·µ
1. **é…ç½®å˜æ›´å‰å¤‡ä»½**: ä¿®æ”¹å…³é”®é…ç½®å‰å…ˆå¤‡ä»½åŸæ–‡ä»¶
2. **æ¸è¿›å¼éªŒè¯**: ä¿®æ”¹åç«‹å³æµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸
3. **å®Œæ•´çš„æ–‡æ¡£è®°å½•**: è¯¦ç»†è®°å½•é—®é¢˜ç°è±¡ã€æ’æŸ¥è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ

##### é¢„é˜²æªæ–½
1. **è‡ªåŠ¨åŒ–ç›‘æ§**: å»ºç«‹APIç«¯ç‚¹çš„å¥åº·æ£€æŸ¥ç›‘æ§
2. **é…ç½®ç®¡ç†**: ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†nginxç­‰å…³é”®é…ç½®æ–‡ä»¶
3. **æ ‡å‡†åŒ–æµç¨‹**: å»ºç«‹æ ‡å‡†çš„æœåŠ¡å¯åŠ¨å’Œæ•…éšœæ’æŸ¥æµç¨‹

---

**é—®é¢˜ä¿®å¤å®Œæˆæ—¶é—´**: 2025å¹´6æœˆ27æ—¥ 18:00  
**ä¿®å¤è´Ÿè´£äºº**: ProductMind AIå¼€å‘å›¢é˜Ÿ  
**éªŒè¯çŠ¶æ€**: âœ… æ‰€æœ‰APIç«¯ç‚¹æ¢å¤æ­£å¸¸ï¼Œæ•°æ®æŸ¥è¯¢åŠŸèƒ½å®Œå…¨æ¢å¤  
**å½±å“èŒƒå›´**: AIäº§å“é¡µé¢æ•°æ®æŸ¥è¯¢åŠŸèƒ½  
**è§£å†³æ–¹æ¡ˆ**: ä¿®å¤nginxä»£ç†é…ç½®ï¼Œå°†Netlify Functionsè¯·æ±‚æ­£ç¡®ä»£ç†åˆ°8888ç«¯å£ 